language: node_js
node_js:
  - "10"
  - "12"

branches:
  only:
    - master

env:
  - MOZ_HEADLESS=1
  - NODE_OPTIONS=--max_old_space_size=8192

addons:
  firefox: latest

before_script: npm run clean && npm run build-test

jobs:
  include:
    - stage: deploy
      if: branch = master
      node_js: "lts/*"
      script: npm run patch && npm run release && npx semantic-release
